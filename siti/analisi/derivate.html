<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scheda Completa Derivate - UniTrento</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- MathJax -->
    <script>
        window.MathJax = {
            tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
            svg: { fontCache: 'global' }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>

    <style>
        body { background-color: #0f172a; font-family: system-ui, sans-serif; }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; }
        .math-row:hover { background-color: rgba(59, 130, 246, 0.1); }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- ICONS ---
        const Icons = {
            Table: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect width="18" height="18" x="3" y="3" rx="2"/><path d="M3 9h18"/><path d="M9 21V9"/></svg>,
            Layers: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polygon points="12 2 2 7 12 12 22 7 12 2"/><polyline points="2 17 12 22 22 17"/><polyline points="2 12 12 17 22 12"/></svg>,
            Code: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg>,
            Menu: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/></svg>
        };

        // --- MATHJAX COMPONENT ---
        const MJ = ({ f, block = false }) => {
            const r = useRef(null);
            useEffect(() => {
                if (window.MathJax && window.MathJax.typesetPromise && r.current) {
                    r.current.innerHTML = block ? `\\[${f}\\]` : `\\(${f}\\)`;
                    window.MathJax.typesetPromise([r.current]).catch(() => {});
                } else { r.current.innerHTML = block ? `\\[${f}\\]` : `\\(${f}\\)`; }
            }, [f]);
            return <span ref={r} />;
        };

        // --- DATA: DERIVATIVES ---
        const elementaryRules = [
            { cat: "Base", f: "k \\text{ (costante)}", df: "0" },
            { cat: "Base", f: "x", df: "1" },
            { cat: "Potenze", f: "x^n", df: "n x^{n-1}" },
            { cat: "Potenze", f: "\\frac{1}{x} = x^{-1}", df: "-\\frac{1}{x^2}" },
            { cat: "Potenze", f: "\\sqrt{x} = x^{1/2}", df: "\\frac{1}{2\\sqrt{x}}" },
            { cat: "Potenze", f: "\\sqrt[n]{x}", df: "\\frac{1}{n\\sqrt[n]{x^{n-1}}}" },
            { cat: "Exp/Log", f: "e^x", df: "e^x" },
            { cat: "Exp/Log", f: "a^x", df: "a^x \\ln(a)" },
            { cat: "Exp/Log", f: "\\ln(x)", df: "\\frac{1}{x}" },
            { cat: "Exp/Log", f: "\\log_a(x)", df: "\\frac{1}{x \\ln(a)}" },
            { cat: "Trigonom.", f: "\\sin(x)", df: "\\cos(x)" },
            { cat: "Trigonom.", f: "\\cos(x)", df: "-\\sin(x)" },
            { cat: "Trigonom.", f: "\\tan(x)", df: "\\frac{1}{\\cos^2(x)} = 1+\\tan^2(x)" },
            { cat: "Trigonom.", f: "\\cot(x)", df: "-\\frac{1}{\\sin^2(x)}" },
            { cat: "Inverse", f: "\\arcsin(x)", df: "\\frac{1}{\\sqrt{1-x^2}}" },
            { cat: "Inverse", f: "\\arccos(x)", df: "-\\frac{1}{\\sqrt{1-x^2}}" },
            { cat: "Inverse", f: "\\arctan(x)", df: "\\frac{1}{1+x^2}" },
        ];

        const chainRules = [
            { name: "Potenza di Funzione", pattern: "[f(x)]^n", res: "n[f(x)]^{n-1} \\cdot f'(x)", ex: "D[(x^2+1)^3] = 3(x^2+1)^2 \\cdot 2x" },
            { name: "Esponenziale", pattern: "e^{f(x)}", res: "e^{f(x)} \\cdot f'(x)", ex: "D[e^{x^2}] = e^{x^2} \\cdot 2x" },
            { name: "Logaritmo", pattern: "\\ln(f(x))", res: "\\frac{f'(x)}{f(x)}", ex: "D[\\ln(\\sin x)] = \\frac{\\cos x}{\\sin x} = \\cot x" },
            { name: "Seno", pattern: "\\sin(f(x))", res: "\\cos(f(x)) \\cdot f'(x)", ex: "D[\\sin(x^2)] = \\cos(x^2) \\cdot 2x" },
            { name: "Coseno", pattern: "\\cos(f(x))", res: "-\\sin(f(x)) \\cdot f'(x)", ex: "D[\\cos(e^x)] = -\\sin(e^x) \\cdot e^x" },
            { name: "Radice", pattern: "\\sqrt{f(x)}", res: "\\frac{f'(x)}{2\\sqrt{f(x)}}", ex: "D[\\sqrt{x^2+1}] = \\frac{2x}{2\\sqrt{x^2+1}}" }
        ];

        // --- COMPONENT: DERIVATIVE TABLE ---
        const DerivTable = () => (
            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                {['Potenze', 'Exp/Log', 'Trigonom.', 'Inverse'].map(category => (
                    <div key={category} className="bg-slate-900 border border-slate-700 rounded-xl overflow-hidden">
                        <div className="bg-slate-800 px-4 py-2 font-bold text-blue-400 border-b border-slate-700">
                            {category}
                        </div>
                        <div className="divide-y divide-slate-800">
                            {elementaryRules.filter(r => r.cat === category || (category === 'Potenze' && r.cat === 'Base')).map((rule, idx) => (
                                <div key={idx} className="grid grid-cols-2 px-4 py-3 math-row transition-colors">
                                    <div className="text-slate-200"><MJ f={`f(x) = ${rule.f}`} /></div>
                                    <div className="text-green-400 font-medium text-right"><MJ f={`f'(x) = ${rule.df}`} /></div>
                                </div>
                            ))}
                        </div>
                    </div>
                ))}
            </div>
        );

        // --- COMPONENT: CHAIN RULE CARDS ---
        const ChainCards = () => (
            <div className="space-y-4">
                {chainRules.map((rule, idx) => (
                    <div key={idx} className="bg-slate-900 border border-slate-700 rounded-xl p-4 flex flex-col md:flex-row md:items-center justify-between gap-4 hover:border-purple-500/50 transition-colors">
                        <div className="md:w-1/4">
                            <span className="text-xs text-slate-500 uppercase font-bold tracking-wider block mb-1">{rule.name}</span>
                            <span className="text-slate-200 text-lg"><MJ f={`D[${rule.pattern}]`} /></span>
                        </div>
                        
                        <div className="hidden md:block text-slate-600"><svg width="24" height="24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M5 12h14M12 5l7 7-7 7"/></svg></div>
                        
                        <div className="md:w-1/4 text-purple-400 font-bold text-lg">
                            <MJ f={rule.res} />
                        </div>

                        <div className="md:w-1/3 bg-slate-950 rounded border border-slate-800 p-3 text-sm text-slate-400">
                            <span className="text-xs text-slate-600 font-mono block mb-1">ESEMPIO:</span>
                            <MJ f={rule.ex} />
                        </div>
                    </div>
                ))}
            </div>
        );

        // --- COMPONENT: CODE EXAMPLE ---
        const CodeLab = () => (
            <div className="bg-[#0d1117] border border-slate-700 rounded-xl p-6 font-mono text-sm">
                <div className="text-slate-400 mb-2"># Esempio reale: Chain Rule in Python (SymPy)</div>
                <div className="text-purple-400">from</div> <span className="text-slate-200">sympy</span> <div className="text-purple-400 inline">import</div> <span className="text-slate-200">symbols, diff, ln, sin</span><br/><br/>
                <span className="text-slate-200">x = symbols(</span><span className="text-green-400">'x'</span><span className="text-slate-200">)</span><br/>
                <span className="text-slate-500"># f(x) = ln(sin(x^2)) -&gt; Doppia concatenazione!</span><br/>
                <span className="text-blue-400">func</span> <span className="text-slate-200">= ln(sin(x**2))</span><br/>
                <span className="text-blue-400">derivata</span> <span className="text-slate-200">= diff(func, x)</span><br/><br/>
                <span className="text-yellow-400">print</span><span className="text-slate-200">(derivata)</span><br/>
                <span className="text-slate-500 mt-2 block"># Output: 2*x*cos(x**2)/sin(x**2)</span>
            </div>
        );

        function App() {
            const [tab, setTab] = useState('scheda'); // 'scheda', 'chain', 'code'

            return (
                <div className="min-h-screen max-w-5xl mx-auto p-4 pb-20">
                    {/* Header */}
                    <header className="py-6 border-b border-slate-800 mb-8 flex justify-between items-center">
                        <div>
                            <h1 className="text-3xl font-bold text-slate-100">Analisi 1 <span className="text-blue-500">Cheat Sheet</span></h1>
                            <p className="text-slate-400 text-sm mt-1">Università di Trento - CdL Informatica</p>
                        </div>
                        <div className="hidden md:block bg-slate-800 px-3 py-1 rounded text-xs text-slate-400 border border-slate-700">
                            v2.0 - Reference Only
                        </div>
                    </header>

                    {/* Navigation Tabs */}
                    <div className="flex gap-2 mb-8 overflow-x-auto pb-2">
                        <button onClick={() => setTab('scheda')} className={`flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-all whitespace-nowrap ${tab === 'scheda' ? 'bg-blue-600 text-white shadow-lg shadow-blue-500/20' : 'bg-slate-800 text-slate-400 hover:bg-slate-700'}`}>
                            <Icons.Table /> Derivate Fondamentali
                        </button>
                        <button onClick={() => setTab('chain')} className={`flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-all whitespace-nowrap ${tab === 'chain' ? 'bg-purple-600 text-white shadow-lg shadow-purple-500/20' : 'bg-slate-800 text-slate-400 hover:bg-slate-700'}`}>
                            <Icons.Layers /> Regole di Concatenazione
                        </button>
                        <button onClick={() => setTab('code')} className={`flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-all whitespace-nowrap ${tab === 'code' ? 'bg-green-600 text-white shadow-lg shadow-green-500/20' : 'bg-slate-800 text-slate-400 hover:bg-slate-700'}`}>
                            <Icons.Code /> Python Snippets
                        </button>
                    </div>

                    {/* Content Areas */}
                    <main className="animate-fade-in">
                        
                        {/* TAB: SCHEDA DERIVATE */}
                        {tab === 'scheda' && (
                            <div className="space-y-8">
                                <div className="bg-blue-900/20 border border-blue-500/30 p-4 rounded-xl flex gap-4 items-start">
                                    <div className="bg-blue-500/20 p-2 rounded text-blue-400 font-bold text-xl">!</div>
                                    <div>
                                        <h3 className="text-blue-200 font-bold">Linearità della Derivata</h3>
                                        <p className="text-slate-400 text-sm">Prima di usare la tabella, ricorda sempre che:</p>
                                        <div className="flex flex-col sm:flex-row gap-4 mt-2 text-slate-200 font-mono text-sm">
                                            <span className="bg-slate-900 px-2 py-1 rounded border border-slate-700"><MJ f="D[k \cdot f(x)] = k \cdot f'(x)" /></span>
                                            <span className="bg-slate-900 px-2 py-1 rounded border border-slate-700"><MJ f="D[f(x) \pm g(x)] = f'(x) \pm g'(x)" /></span>
                                        </div>
                                    </div>
                                </div>
                                <DerivTable />
                            </div>
                        )}

                        {/* TAB: CHAIN RULE (Concatenazione) */}
                        {tab === 'chain' && (
                            <div className="space-y-8">
                                <div className="bg-slate-900 p-6 rounded-xl border border-slate-800 text-center">
                                    <h2 className="text-slate-200 font-bold text-xl mb-2">La Regola d'Oro</h2>
                                    <p className="text-slate-400 mb-4">Derivi la funzione esterna, mantieni l'interna invariata, moltiplichi per la derivata interna.</p>
                                    <div className="inline-block bg-slate-950 px-8 py-4 rounded-lg border border-purple-500/50 shadow-[0_0_15px_rgba(168,85,247,0.1)]">
                                        <span className="text-2xl text-white font-bold">
                                            <MJ f="D[f(g(x))] = f'(g(x)) \cdot g'(x)" />
                                        </span>
                                    </div>
                                </div>

                                <h3 className="text-xl font-bold text-slate-100 border-l-4 border-purple-500 pl-3">Pattern Comuni</h3>
                                <ChainCards />

                                <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mt-6">
                                    <div className="bg-slate-800/50 border border-slate-700 p-4 rounded-lg">
                                        <h4 className="text-white font-bold mb-2">Regola del Prodotto</h4>
                                        <MJ f="D[f \cdot g] = f'g + fg'" block={true} />
                                    </div>
                                    <div className="bg-slate-800/50 border border-slate-700 p-4 rounded-lg">
                                        <h4 className="text-white font-bold mb-2">Regola del Quoziente</h4>
                                        <MJ f="D[\frac{f}{g}] = \frac{f'g - fg'}{g^2}" block={true} />
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* TAB: CODE */}
                        {tab === 'code' && (
                            <div>
                                <h3 className="text-xl font-bold text-slate-100 mb-4">Verifica i risultati con Python</h3>
                                <p className="text-slate-400 mb-6">Durante lo studio, usa SymPy per verificare se hai applicato correttamente la Chain Rule.</p>
                                <CodeLab />
                            </div>
                        )}

                    </main>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>